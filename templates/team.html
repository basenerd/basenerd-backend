{% extends "base.html" %}
{% block content %}

<div class="card">
  <div class="card-header">
    <div class="teamcell" style="gap:10px;">
      {% if team.logo_url %}
        <img class="teamlogo" src="{{ team.logo_url }}" alt="{{ team.name }} logo" style="height:28px;">
      {% endif %}
      <div>
        <div class="card-title">{{ team.name }}</div>
        <div class="card-subtitle">
          {% if team.division %}{{ team.division }}{% endif %}
          {% if team.venue %} • {{ team.venue }}{% endif %}
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ===================== -->
<!-- 40-MAN ROSTER DROPDOWN -->
<!-- ===================== -->

<div class="card" style="margin-top:18px;">
  <div class="card-header">
    <details class="roster-details">
      <summary class="roster-summary">
        <div class="card-title" style="margin:0;">40-Man Roster</div>
        <span class="muted" style="font-size:12px;">Click to expand</span>
      </summary>

      <div class="card-body" style="padding-top:10px;">

        {% set bucket_label = {
          "Pitcher": "Pitchers",
          "Catcher": "Catchers",
          "Infielder": "Infielders",
          "Outfielder": "Outfielders"
        } %}

        {% for bucket, players in (roster_grouped or {}).items() %}
          {% if players %}
            <div class="subcard" style="margin-top:12px;">
              <div class="subcard-title">{{ bucket_label.get(bucket, bucket ~ "s") }}</div>

              <table class="table">
                <thead>
                  <tr>
                    <td style="width:44px; text-align:right;"><strong>#</strong></td>
                    <td><strong>Player</strong></td>
                    <td style="width:70px; text-align:right;"><strong>B/T</strong></td>
                    <td style="width:60px; text-align:right;"><strong>Pos</strong></td>
                  </tr>
                </thead>
                <tbody>
                  {% for p in players %}
                    <tr>
                      <td style="text-align:right; font-variant-numeric: tabular-nums;">
                        {{ p.jersey or "—" }}
                      </td>

                      <td style="white-space:nowrap;">
                        {{ p.name }}

                        {% if p.status_code and p.status_code not in ["A"] %}
                          {% set code = p.status_code %}
                          <span class="status-pill
                            {% if code == 'IL' %} status-il
                            {% elif code == 'MIN' %} status-min
                            {% else %} status-other
                            {% endif %}"
                            title="{{ p.status_desc }}">
                            {{ code }}
                          </span>
                        {% endif %}
                      </td>

                      <td style="text-align:right; font-variant-numeric: tabular-nums;">
                        {{ p.bt or "—" }}
                      </td>

                      <td style="text-align:right;">
                        {{ p.pos or "—" }}
                      </td>
                    </tr>
                  {% endfor %}
                </tbody>
              </table>

            </div>
          {% endif %}
        {% endfor %}

        {% if roster_other %}
          <div class="subcard" style="margin-top:12px;">
            <div class="subcard-title">Other</div>

            <table class="table">
              <thead>
                <tr>
                  <td style="width:44px; text-align:right;"><strong>#</strong></td>
                  <td><strong>Player</strong></td>
                  <td style="width:70px; text-align:right;"><strong>B/T</strong></td>
                  <td style="width:60px; text-align:right;"><strong>Pos</strong></td>
                </tr>
              </thead>
              <tbody>
                {% for p in roster_other %}
                  <tr>
                    <td style="text-align:right; font-variant-numeric: tabular-nums;">{{ p.jersey or "—" }}</td>

                    <td style="white-space:nowrap;">
                      {{ p.name }}

                      {% if p.status_code and p.status_code not in ["A"] %}
                        {% set code = p.status_code %}
                        <span class="status-pill
                          {% if code == 'IL' %} status-il
                          {% elif code == 'MIN' %} status-min
                          {% else %} status-other
                          {% endif %}"
                          title="{{ p.status_desc }}">
                          {{ code }}
                        </span>
                      {% endif %}
                    </td>

                    <td style="text-align:right; font-variant-numeric: tabular-nums;">{{ p.bt or "—" }}</td>
                    <td style="text-align:right;">{{ p.pos or "—" }}</td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% endif %}

      </div>
    </details>
  </div>
</div>

<!-- Local styles for dropdown + status pills -->
<style>
  .roster-details { width: 100%; }
  .roster-summary {
    cursor: pointer;
    user-select: none;
    display: flex;
    align-items: baseline;
    justify-content: space-between;
    gap: 12px;
    padding: 0;
    list-style: none;
  }
  .roster-summary::-webkit-details-marker { display: none; }

  .status-pill{
    display:inline-block;
    margin-left:8px;
    padding:2px 8px;
    border-radius:999px;
    font-size:11px;
    line-height:1.2;
    vertical-align:middle;
  }
  .status-il{
    background: rgba(255, 0, 0, 0.18);
    color: rgba(255, 170, 170, 0.95);
    border: 1px solid rgba(255, 0, 0, 0.28);
  }
  .status-min{
    background: rgba(160, 160, 160, 0.18);
    color: rgba(220, 220, 220, 0.95);
    border: 1px solid rgba(180, 180, 180, 0.22);
  }
  .status-other{
    background: rgba(255,255,255,0.10);
    color: rgba(235,235,235,0.95);
    border: 1px solid rgba(255,255,255,0.12);
  }
</style>

{% endblock %}
